{"ast":null,"code":"import _regeneratorRuntime from\"/home/ctapang/dapp-scaffold/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/ctapang/dapp-scaffold/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/ctapang/dapp-scaffold/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/ctapang/dapp-scaffold/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/ctapang/dapp-scaffold/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/ctapang/dapp-scaffold/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import EventEmitter from\"eventemitter3\";import TransportWebUSB from\"@ledgerhq/hw-transport-webusb\";import{notify}from\"../../utils/notifications\";import{getPublicKey,signTransaction as _signTransaction}from\"./core\";export var LedgerWalletAdapter=/*#__PURE__*/function(_EventEmitter){_inherits(LedgerWalletAdapter,_EventEmitter);var _super=_createSuper(LedgerWalletAdapter);function LedgerWalletAdapter(){var _this;_classCallCheck(this,LedgerWalletAdapter);_this=_super.call(this);_this._connecting=void 0;_this._publicKey=void 0;_this._transport=void 0;_this._connecting=false;_this._publicKey=null;_this._transport=null;return _this;}_createClass(LedgerWalletAdapter,[{key:\"signTransaction\",value:function(){var _signTransaction2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(transaction){var signature;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(!this._transport||!this._publicKey)){_context.next=2;break;}throw new Error(\"Not connected to Ledger\");case 2:_context.next=4;return _signTransaction(this._transport,transaction);case 4:signature=_context.sent;transaction.addSignature(this._publicKey,signature);return _context.abrupt(\"return\",transaction);case 7:case\"end\":return _context.stop();}}},_callee,this);}));function signTransaction(_x){return _signTransaction2.apply(this,arguments);}return signTransaction;}()},{key:\"connect\",value:function(){var _connect=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!this._connecting){_context2.next=2;break;}return _context2.abrupt(\"return\");case 2:this._connecting=true;_context2.prev=3;_context2.next=6;return TransportWebUSB.create();case 6:this._transport=_context2.sent;_context2.next=9;return getPublicKey(this._transport);case 9:this._publicKey=_context2.sent;this.emit(\"connect\",this._publicKey);_context2.next=18;break;case 13:_context2.prev=13;_context2.t0=_context2[\"catch\"](3);notify({message:\"Ledger Error\",description:_context2.t0.message});_context2.next=18;return this.disconnect();case 18:_context2.prev=18;this._connecting=false;return _context2.finish(18);case 21:case\"end\":return _context2.stop();}}},_callee2,this,[[3,13,18,21]]);}));function connect(){return _connect.apply(this,arguments);}return connect;}()},{key:\"disconnect\",value:function(){var _disconnect=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var emit;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:emit=false;if(!this._transport){_context3.next=6;break;}_context3.next=4;return this._transport.close();case 4:this._transport=null;emit=true;case 6:this._connecting=false;this._publicKey=null;if(emit){this.emit(\"disconnect\");}case 9:case\"end\":return _context3.stop();}}},_callee3,this);}));function disconnect(){return _disconnect.apply(this,arguments);}return disconnect;}()},{key:\"publicKey\",get:function get(){return this._publicKey;}}]);return LedgerWalletAdapter;}(EventEmitter);","map":null,"metadata":{},"sourceType":"module"}