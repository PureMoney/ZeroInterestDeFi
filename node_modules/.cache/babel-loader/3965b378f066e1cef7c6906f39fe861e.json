{"ast":null,"code":"import _slicedToArray from\"/home/ctapang/dapp-scaffold/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import Wallet from\"@project-serum/sol-wallet-adapter\";import{Button,Modal}from\"antd\";import React,{useCallback,useContext,useEffect,useMemo,useState}from\"react\";import{notify}from\"./../utils/notifications\";import{useConnectionConfig}from\"./connection\";import{useLocalStorageState}from\"./../utils/utils\";import{LedgerWalletAdapter}from\"../wallet-adapters/ledger\";import{SolongWalletAdapter}from\"../wallet-adapters/solong\";import{PhantomWalletAdapter}from\"../wallet-adapters/phantom\";var ASSETS_URL=\"https://raw.githubusercontent.com/solana-labs/oyster/main/assets/wallets/\";export var WALLET_PROVIDERS=[{name:\"Sollet\",url:\"https://www.sollet.io\",icon:\"\".concat(ASSETS_URL,\"sollet.svg\")},{name:\"Solong\",url:\"https://solongwallet.com\",icon:\"\".concat(ASSETS_URL,\"solong.png\"),adapter:SolongWalletAdapter},{name:\"Solflare\",url:\"https://solflare.com/access-wallet\",icon:\"\".concat(ASSETS_URL,\"solflare.svg\")},{name:\"MathWallet\",url:\"https://mathwallet.org\",icon:\"\".concat(ASSETS_URL,\"mathwallet.svg\")},{name:\"Ledger\",url:\"https://www.ledger.com\",icon:\"\".concat(ASSETS_URL,\"ledger.svg\"),adapter:LedgerWalletAdapter},{name:\"Phantom\",url:\"https://phantom.app/\",icon:\"https://raydium.io/_nuxt/img/phantom.d9e3c61.png\",adapter:PhantomWalletAdapter}];var WalletContext=React.createContext({wallet:undefined,connected:false,select:function select(){},provider:undefined});export function WalletProvider(_ref){var _ref$children=_ref.children,children=_ref$children===void 0?null:_ref$children;var _useConnectionConfig=useConnectionConfig(),endpoint=_useConnectionConfig.endpoint;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),autoConnect=_useState2[0],setAutoConnect=_useState2[1];var _useLocalStorageState=useLocalStorageState(\"walletProvider\"),_useLocalStorageState2=_slicedToArray(_useLocalStorageState,2),providerUrl=_useLocalStorageState2[0],setProviderUrl=_useLocalStorageState2[1];var provider=useMemo(function(){return WALLET_PROVIDERS.find(function(_ref2){var url=_ref2.url;return url===providerUrl;});},[providerUrl]);var wallet=useMemo(function(){if(provider){return new(provider.adapter||Wallet)(providerUrl,endpoint);}},[provider,providerUrl,endpoint]);var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),connected=_useState4[0],setConnected=_useState4[1];useEffect(function(){if(wallet){wallet.on(\"connect\",function(){if(wallet.publicKey){setConnected(true);var walletPublicKey=wallet.publicKey.toBase58();var keyToDisplay=walletPublicKey.length>20?\"\".concat(walletPublicKey.substring(0,7),\".....\").concat(walletPublicKey.substring(walletPublicKey.length-7,walletPublicKey.length)):walletPublicKey;notify({message:\"Wallet update\",description:\"Connected to wallet \"+keyToDisplay});}});wallet.on(\"disconnect\",function(){setConnected(false);notify({message:\"Wallet update\",description:\"Disconnected from wallet\"});});}return function(){setConnected(false);if(wallet){wallet.disconnect();}};},[wallet]);useEffect(function(){if(wallet&&autoConnect){wallet.connect();setAutoConnect(false);}return function(){};},[wallet,autoConnect]);var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isModalVisible=_useState6[0],setIsModalVisible=_useState6[1];var select=useCallback(function(){return setIsModalVisible(true);},[]);var close=useCallback(function(){return setIsModalVisible(false);},[]);return/*#__PURE__*/React.createElement(WalletContext.Provider,{value:{wallet:wallet,connected:connected,select:select,provider:provider}},children,/*#__PURE__*/React.createElement(Modal,{title:\"Select Wallet\",okText:\"Connect\",visible:isModalVisible,okButtonProps:{style:{display:\"none\"}},onCancel:close,width:400},WALLET_PROVIDERS.map(function(provider){var onClick=function onClick(){setProviderUrl(provider.url);setAutoConnect(true);close();};return/*#__PURE__*/React.createElement(Button,{size:\"large\",type:providerUrl===provider.url?\"primary\":\"ghost\",onClick:onClick,icon:/*#__PURE__*/React.createElement(\"img\",{alt:\"\".concat(provider.name),width:20,height:20,src:provider.icon,style:{marginRight:8}}),style:{display:\"block\",width:\"100%\",textAlign:\"left\",marginBottom:8}},provider.name);})));}export function useWallet(){var _useContext=useContext(WalletContext),wallet=_useContext.wallet,connected=_useContext.connected,provider=_useContext.provider,select=_useContext.select;return{wallet:wallet,connected:connected,provider:provider,select:select,publicKey:wallet===null||wallet===void 0?void 0:wallet.publicKey,connect:function connect(){wallet?wallet.connect():select();},disconnect:function disconnect(){wallet===null||wallet===void 0?void 0:wallet.disconnect();}};}","map":null,"metadata":{},"sourceType":"module"}