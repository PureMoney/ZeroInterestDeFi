{"ast":null,"code":"import _slicedToArray from\"/home/ctapang/dapp-scaffold/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useMemo,useState}from\"react\";import{useMint}from\"../contexts/accounts\";import{useMarkets}from\"../contexts/market\";import{fromLamports}from\"../utils/utils\";import{useUserAccounts}from\"./useUserAccounts\";export function useUserBalance(mintAddress,account){var mint=useMemo(function(){return typeof mintAddress===\"string\"?mintAddress:mintAddress===null||mintAddress===void 0?void 0:mintAddress.toBase58();},[mintAddress]);var _useUserAccounts=useUserAccounts(),userAccounts=_useUserAccounts.userAccounts;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),balanceInUSD=_useState2[0],setBalanceInUSD=_useState2[1];var _useMarkets=useMarkets(),marketEmitter=_useMarkets.marketEmitter,midPriceInUSD=_useMarkets.midPriceInUSD;var mintInfo=useMint(mint);var accounts=useMemo(function(){return userAccounts.filter(function(acc){return mint===acc.info.mint.toBase58()&&(!account||account.equals(acc.pubkey));}).sort(function(a,b){return b.info.amount.sub(a.info.amount).toNumber();});},[userAccounts,mint,account]);var balanceLamports=useMemo(function(){return accounts.reduce(function(res,item){return res+=item.info.amount.toNumber();},0);},[accounts]);var balance=useMemo(function(){return fromLamports(balanceLamports,mintInfo);},[mintInfo,balanceLamports]);useEffect(function(){var updateBalance=function updateBalance(){setBalanceInUSD(balance*midPriceInUSD(mint||\"\"));};var dispose=marketEmitter.onMarket(function(args){updateBalance();});updateBalance();return function(){dispose();};},[balance,midPriceInUSD,marketEmitter,mint,setBalanceInUSD]);return{balance:balance,balanceLamports:balanceLamports,balanceInUSD:balanceInUSD,accounts:accounts,hasBalance:accounts.length>0&&balance>0};}","map":null,"metadata":{},"sourceType":"module"}